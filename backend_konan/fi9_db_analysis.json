{
  "users": {
    "actual": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "default": "nextval('users_id_seq'::regclass)",
          "autoincrement": true
        },
        "email": {
          "type": "VARCHAR",
          "nullable": false,
          "default": null,
          "autoincrement": false
        },
        "hashed_password": {
          "type": "VARCHAR",
          "nullable": false,
          "default": null,
          "autoincrement": false
        },
        "full_name": {
          "type": "VARCHAR",
          "nullable": true,
          "default": null,
          "autoincrement": false
        },
        "plan": {
          "type": "VARCHAR(10)",
          "nullable": true,
          "default": "'FREE'::plan_type",
          "autoincrement": false
        },
        "is_active": {
          "type": "BOOLEAN",
          "nullable": true,
          "default": null,
          "autoincrement": false
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "default": "now()",
          "autoincrement": false
        }
      },
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [],
      "indexes": [
        {
          "name": "ix_users_email",
          "columns": [
            "email"
          ],
          "unique": true
        }
      ],
      "foreign_keys": []
    },
    "expected": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "primary_key": true,
          "autoincrement": true
        },
        "supabase_id": {
          "type": "VARCHAR(255)",
          "nullable": false,
          "unique": true,
          "index": true
        },
        "email": {
          "type": "VARCHAR(255)",
          "nullable": false,
          "unique": true,
          "index": true
        },
        "full_name": {
          "type": "VARCHAR(255)",
          "nullable": true
        },
        "role": {
          "type": "VARCHAR(50)",
          "nullable": true,
          "default": "'user'"
        },
        "plan": {
          "type": "plan_type",
          "nullable": false,
          "default": "'FREE'"
        },
        "is_active": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": "true"
        },
        "created_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        },
        "updated_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        }
      },
      "indexes": [
        {
          "name": "ix_users_supabase_id",
          "columns": [
            "supabase_id"
          ],
          "unique": true
        },
        {
          "name": "ix_users_email",
          "columns": [
            "email"
          ],
          "unique": true
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "supabase_id"
          ]
        },
        {
          "columns": [
            "email"
          ]
        }
      ]
    },
    "differences": {
      "missing_columns": [
        "supabase_id",
        "role",
        "updated_at"
      ],
      "missing_indexes": [
        {
          "name": "ix_users_supabase_id",
          "columns": [
            "supabase_id"
          ],
          "unique": true
        }
      ],
      "missing_unique_constraints": [
        {
          "columns": [
            "supabase_id"
          ]
        },
        {
          "columns": [
            "email"
          ]
        }
      ],
      "missing_foreign_keys": [],
      "column_differences": [
        {
          "column": "is_active",
          "issue": "nullable: actual=True, expected=False"
        },
        {
          "column": "created_at",
          "issue": "nullable: actual=True, expected=False"
        },
        {
          "column": "plan",
          "issue": "nullable: actual=True, expected=False"
        }
      ],
      "alter_statements": [],
      "table_missing": false
    }
  },
  "conversations": {
    "actual": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "default": "nextval('conversations_id_seq'::regclass)",
          "autoincrement": true
        },
        "session_id": {
          "type": "VARCHAR(255)",
          "nullable": false,
          "default": null,
          "autoincrement": false
        },
        "role": {
          "type": "VARCHAR",
          "nullable": true,
          "default": null,
          "autoincrement": false
        },
        "message_user": {
          "type": "TEXT",
          "nullable": true,
          "default": null,
          "autoincrement": false
        },
        "message_konan": {
          "type": "TEXT",
          "nullable": true,
          "default": null,
          "autoincrement": false
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "default": "now()",
          "autoincrement": false
        }
      },
      "primary_keys": [
        "id"
      ],
      "unique_constraints": [],
      "indexes": [
        {
          "name": "ix_conversations_id",
          "columns": [
            "id"
          ],
          "unique": false
        },
        {
          "name": "ix_conversations_session_id",
          "columns": [
            "session_id"
          ],
          "unique": false
        }
      ],
      "foreign_keys": []
    },
    "expected": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "primary_key": true,
          "autoincrement": true
        },
        "user_id": {
          "type": "INTEGER",
          "nullable": false,
          "foreign_key": "users.id"
        },
        "session_id": {
          "type": "VARCHAR(255)",
          "nullable": false,
          "index": true
        },
        "title": {
          "type": "VARCHAR(500)",
          "nullable": true
        },
        "created_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        },
        "updated_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        }
      },
      "indexes": [
        {
          "name": "ix_conversations_user_id",
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "name": "ix_conversations_session_id",
          "columns": [
            "session_id"
          ],
          "unique": false
        }
      ],
      "foreign_keys": [
        {
          "columns": [
            "user_id"
          ],
          "referred_table": "users",
          "referred_columns": [
            "id"
          ],
          "ondelete": "CASCADE"
        }
      ]
    },
    "differences": {
      "missing_columns": [
        "title",
        "updated_at",
        "user_id"
      ],
      "missing_indexes": [
        {
          "name": "ix_conversations_user_id",
          "columns": [
            "user_id"
          ],
          "unique": false
        }
      ],
      "missing_unique_constraints": [],
      "missing_foreign_keys": [
        {
          "columns": [
            "user_id"
          ],
          "referred_table": "users",
          "referred_columns": [
            "id"
          ],
          "ondelete": "CASCADE"
        }
      ],
      "column_differences": [
        {
          "column": "created_at",
          "issue": "nullable: actual=True, expected=False"
        }
      ],
      "alter_statements": [],
      "table_missing": false
    }
  },
  "messages": {
    "actual": null,
    "expected": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "primary_key": true,
          "autoincrement": true
        },
        "conversation_id": {
          "type": "INTEGER",
          "nullable": false,
          "foreign_key": "conversations.id"
        },
        "role": {
          "type": "VARCHAR(50)",
          "nullable": false
        },
        "content": {
          "type": "TEXT",
          "nullable": false
        },
        "metadata": {
          "type": "JSON",
          "nullable": true
        },
        "created_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        }
      },
      "indexes": [
        {
          "name": "ix_messages_conversation_id",
          "columns": [
            "conversation_id"
          ],
          "unique": false
        },
        {
          "name": "ix_messages_created_at",
          "columns": [
            "created_at"
          ],
          "unique": false
        }
      ],
      "foreign_keys": [
        {
          "columns": [
            "conversation_id"
          ],
          "referred_table": "conversations",
          "referred_columns": [
            "id"
          ],
          "ondelete": "CASCADE"
        }
      ]
    },
    "differences": {
      "missing_columns": [],
      "missing_indexes": [],
      "missing_unique_constraints": [],
      "missing_foreign_keys": [],
      "column_differences": [],
      "alter_statements": [],
      "table_missing": true
    }
  },
  "user_settings": {
    "actual": null,
    "expected": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "primary_key": true,
          "autoincrement": true
        },
        "user_id": {
          "type": "INTEGER",
          "nullable": false,
          "foreign_key": "users.id",
          "unique": true
        },
        "language": {
          "type": "VARCHAR(10)",
          "nullable": true,
          "default": "'fr'"
        },
        "theme": {
          "type": "VARCHAR(20)",
          "nullable": true,
          "default": "'light'"
        },
        "notifications_enabled": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": "true"
        },
        "preferences": {
          "type": "JSON",
          "nullable": true
        },
        "created_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        },
        "updated_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        }
      },
      "indexes": [
        {
          "name": "ix_user_settings_user_id",
          "columns": [
            "user_id"
          ],
          "unique": true
        }
      ],
      "foreign_keys": [
        {
          "columns": [
            "user_id"
          ],
          "referred_table": "users",
          "referred_columns": [
            "id"
          ],
          "ondelete": "CASCADE"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "user_id"
          ]
        }
      ]
    },
    "differences": {
      "missing_columns": [],
      "missing_indexes": [],
      "missing_unique_constraints": [],
      "missing_foreign_keys": [],
      "column_differences": [],
      "alter_statements": [],
      "table_missing": true
    }
  },
  "audit_logs": {
    "actual": null,
    "expected": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "primary_key": true,
          "autoincrement": true
        },
        "user_id": {
          "type": "INTEGER",
          "nullable": true,
          "foreign_key": "users.id"
        },
        "action": {
          "type": "VARCHAR(100)",
          "nullable": false
        },
        "resource_type": {
          "type": "VARCHAR(100)",
          "nullable": true
        },
        "resource_id": {
          "type": "INTEGER",
          "nullable": true
        },
        "ip_address": {
          "type": "VARCHAR(45)",
          "nullable": true
        },
        "user_agent": {
          "type": "VARCHAR(500)",
          "nullable": true
        },
        "metadata": {
          "type": "JSON",
          "nullable": true
        },
        "created_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        }
      },
      "indexes": [
        {
          "name": "ix_audit_logs_user_id",
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "name": "ix_audit_logs_action",
          "columns": [
            "action"
          ],
          "unique": false
        },
        {
          "name": "ix_audit_logs_created_at",
          "columns": [
            "created_at"
          ],
          "unique": false
        }
      ],
      "foreign_keys": [
        {
          "columns": [
            "user_id"
          ],
          "referred_table": "users",
          "referred_columns": [
            "id"
          ],
          "ondelete": "SET NULL"
        }
      ]
    },
    "differences": {
      "missing_columns": [],
      "missing_indexes": [],
      "missing_unique_constraints": [],
      "missing_foreign_keys": [],
      "column_differences": [],
      "alter_statements": [],
      "table_missing": true
    }
  },
  "legal_search_history": {
    "actual": null,
    "expected": {
      "columns": {
        "id": {
          "type": "INTEGER",
          "nullable": false,
          "primary_key": true,
          "autoincrement": true
        },
        "user_id": {
          "type": "INTEGER",
          "nullable": false,
          "foreign_key": "users.id"
        },
        "query": {
          "type": "TEXT",
          "nullable": false
        },
        "results_count": {
          "type": "INTEGER",
          "nullable": true
        },
        "filters": {
          "type": "JSON",
          "nullable": true
        },
        "created_at": {
          "type": "TIMESTAMP WITH TIME ZONE",
          "nullable": false,
          "default": "now()"
        }
      },
      "indexes": [
        {
          "name": "ix_legal_search_history_user_id",
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "name": "ix_legal_search_history_created_at",
          "columns": [
            "created_at"
          ],
          "unique": false
        }
      ],
      "foreign_keys": [
        {
          "columns": [
            "user_id"
          ],
          "referred_table": "users",
          "referred_columns": [
            "id"
          ],
          "ondelete": "CASCADE"
        }
      ]
    },
    "differences": {
      "missing_columns": [],
      "missing_indexes": [],
      "missing_unique_constraints": [],
      "missing_foreign_keys": [],
      "column_differences": [],
      "alter_statements": [],
      "table_missing": true
    }
  }
}